{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modifier Fournisseur</title>
    <link rel="stylesheet" href="{% static 'css/ModifierFournisseur.css' %}">
</head>
<body>
    <!-- Overlay Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-container">
            <!-- Modal Header -->
            <div class="modal-header">
                <div class="header-icon">
                    <div class="icon-circle">
                        üöö
                    </div>
                </div>
                <h2 class="modal-title">Modifier Fournisseur</h2>
                <p class="modal-subtitle">Mettre √† jour les informations du fournisseur</p>
                <button class="btn-close" id="btnClose">‚úï</button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                <form id="formModifierFournisseur" method="POST" action="{% url 'modifier_fournisseur' fournisseur.idFournisseur %}">
                    {% csrf_token %}
                    <!-- ID Fournisseur (Read Only) -->
                    <div class="form-group">
                        <label for="idFournisseur" class="form-label">
                            ID Fournisseur
                        </label>
                        <input 
                            type="text" 
                            id="idFournisseur" 
                            name="idFournisseur" 
                            class="form-input input-readonly" 
                            value="SACO"
                            readonly
                        >
                        <small class="form-help">L'ID du fournisseur ne peut pas √™tre modifi√©</small>
                    </div>

                    <!-- Nom du Fournisseur -->
                    <div class="form-group">
                        <label for="nom" class="form-label">
                            Nom du Fournisseur <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="nom" 
                            name="nom" 
                            class="form-input" 
                            placeholder="Ex: SACO Distribution"
                            value="{{ fournisseur.nom }}"
                            required
                        >
                    </div>

                    <!-- Row: Contact et Email -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contact" class="form-label">
                                Personne de Contact
                            </label>
                            <input 
                                type="text" 
                                id="contact" 
                                name="contact" 
                                class="form-input" 
                                placeholder="Ex: R√©my Djimy"
                                value="{{ fournisseur.contact }}"
                            >
                        </div>

                        <div class="form-group">
                            <label for="email" class="form-label">
                                Email <span class="required">*</span>
                            </label>
                            <input 
                                type="email" 
                                id="email" 
                                name="email" 
                                class="form-input" 
                                placeholder="exemple@email.com"
                                value="{{ fournisseur.email }}"
                                required
                            >
                        </div>
                    </div>

                    <!-- Row: T√©l√©phone et D√©lai -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="telephone" class="form-label">
                                T√©l√©phone <span class="required">*</span>
                            </label>
                            <input 
                                type="tel" 
                                id="telephone" 
                                name="telephone" 
                                class="form-input" 
                                placeholder="+225 XX XX XX XX XX"
                                value="{{ fournisseur.telephone }}"
                                required
                            >
                        </div>

                        <div class="form-group">
                            <label for="delaiLivraison" class="form-label">
                                D√©lai de Livraison (jours) <span class="required">*</span>
                            </label>
                            <input 
                                type="number" 
                                id="delaiLivraison" 
                                name="delaiLivraison" 
                                class="form-input" 
                                placeholder="Ex: 5"
                                value="{{ fournisseur.delaiLivraison }}"
                                min="1"
                                required
                            >
                        </div>
                    </div>

                    <!-- Adresse -->
                    <div class="form-group">
                        <label for="adresse" class="form-label">
                            Adresse <span class="required">*</span>
                        </label>
                        <textarea 
                            id="adresse" 
                            name="adresse" 
                            class="form-textarea" 
                            rows="3"
                            placeholder="Adresse compl√®te du fournisseur..."
                            required
                        >Adidogame</textarea>
                    </div>

                    <!-- √âvaluation Qualit√© -->
                    <div class="form-group">
                        <label for="evaluationQualite" class="form-label">
                            √âvaluation Qualit√© <span class="required">*</span>
                        </label>
                        <div class="rating-input-container">
                            <input 
                                type="number" 
                                id="evaluationQualite" 
                                name="evaluationQualite" 
                                class="form-input" 
                                placeholder="0.0"
                                value="{{ fournisseur.evaluationQualite }}"
                                min="0"
                                max="5"
                                step="0.1"
                                required
                            >
                            <div class="rating-stars">
                                <span class="star filled">‚òÖ</span>
                                <span class="star filled">‚òÖ</span>
                                <span class="star filled">‚òÖ</span>
                                <span class="star filled">‚òÖ</span>
                                <span class="star half">‚òÖ</span>
                            </div>
                        </div>
                        <small class="form-help">Note sur 5 √©toiles</small>
                    </div>

                    <!-- Info Box -->
                    <div class="info-box">
                        <span class="info-icon">‚ÑπÔ∏è</span>
                        <p class="info-text">
                            Les modifications seront imm√©diatement appliqu√©es apr√®s enregistrement.
                        </p>
                    </div>

                    <!-- Modal Footer -->
                    <div class="modal-footer">
                        <a type="button" class="btn-secondary" id="btnCancel">
                            Annuler
                        </a>
                        <button type="submit" class="btn-primary">
                            <span class="btn-icon">‚úì</span>
                            Enregistrer les modifications
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // JavaScript pour g√©rer la modal
        const modalOverlay = document.getElementById('modalOverlay');
        const btnClose = document.getElementById('btnClose');
        const btnCancel = document.getElementById('btnCancel');
        const evaluationInput = document.getElementById('evaluationQualite');
        const stars = document.querySelectorAll('.star');

        // Fermer la modal
        btnClose.addEventListener('click', () => {
            modalOverlay.style.display = 'none';
        });

        btnCancel.addEventListener('click', () => {
            modalOverlay.style.display = 'none';
        });

        // Fermer si clic en dehors de la modal
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
                modalOverlay.style.display = 'none';
            }
        });

        // Mise √† jour des √©toiles en fonction de la note
        function updateStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = (rating % 1) >= 0.5;
            
            stars.forEach((star, index) => {
                star.classList.remove('filled', 'half', 'empty');
                
                if (index < fullStars) {
                    star.classList.add('filled');
                } else if (index === fullStars && hasHalfStar) {
                    star.classList.add('half');
                } else {
                    star.classList.add('empty');
                }
            });
        }

        // √âcouter les changements de la note
        evaluationInput.addEventListener('input', (e) => {
            const value = parseFloat(e.target.value) || 0;
            updateStars(value);
        });

        // Initialiser les √©toiles
        updateStars(parseFloat(evaluationInput.value));

        // Afficher la modal au chargement (pour test)
        window.addEventListener('load', () => {
            modalOverlay.style.display = 'flex';
        });
    </script>
</body>
</html>